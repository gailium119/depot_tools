{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "74954b89_7eb67f09",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 1560543
      },
      "writtenOn": "2024-12-05T16:42:09Z",
      "side": 1,
      "message": "I don\u0027t think we should do this - it complicates code and adds a bit of latency (since it invokes git config additional N times, N\u003d4). And it\u0027s unlikely the user sets it by hand.",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be93f751_9e3c23ba",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 1126912
      },
      "writtenOn": "2024-12-05T17:35:07Z",
      "side": 1,
      "message": "drive-by: I would disagree that users are unlikely to set this by hand. Maybe when unprompted before this warning but certainly not after the warning has been updated in the subsequent 1-2 patches (which also imo makes setting this less scary).\n\nWe\u0027re getting multiple reports in the wild (slack, team chats) that people are confused about what `depot-tools.allowGlobalGitConfig` would do and are hesitant to set it and people have linked to the `GIT_GLOBAL_CONFIG` code as a workaround. I can empathise with that and would probably set them once myself and then set `tools.allowGlobalGitConfig\u003dfalse` to silence the warning, but that means I won\u0027t be notified of any future changes you think are good for me.\n\nAlso since we already have to warn if any of these are off we do need to read the config. What if we use and parse `git config --list --global` to limit this to a single invocation then?\n\n```\n$ git config --list --global\nuser.email\u003dpbos@chromium.org\nhttp.cookiefile\u003d/Users/pbos/.gitcookies\nmaintenance.repo\u003d/Users/pbos/chromium/src\n```",
      "parentUuid": "74954b89_7eb67f09",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7015b774_95b8e09f",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 1560543
      },
      "writtenOn": "2024-12-05T17:47:34Z",
      "side": 1,
      "message": "My suggestion in https://crrev.com/c/6072989/2 is to set `depot-tools.gitPostprocessVersion\u003d{version}`. We can elaborate what that config is used for. That way, we don\u0027t need to check each value - we can just assume that the configs are set correctly (which is the current behavior too).\n\nMoreover, with that change, the user won\u0027t need to set allowGlobalGitConfig config. If there\u0027s a bump in gitPostprocessVersion (which we rarely do), the user will know about the change. \n\nDo you think that\u0027s a good outcome, or do you think we should still proceed with this change?",
      "parentUuid": "be93f751_9e3c23ba",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d36b3b7_7de34398",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 1126912
      },
      "writtenOn": "2024-12-05T18:03:14Z",
      "side": 1,
      "message": "I still think we need to tell (some) users what we\u0027re about to do and let them decide themselves. I think it\u0027s good to support users accepting the current best practices but be prompted if the best practices change, with a diff and suggested changes. Does that remove the need for `gitPostprocessVersion` completely? That\u0027d be a win right?\n\nI suspect that some users won\u0027t touch something automatic like `allowGlobalGitConfig\u003dtrue` with a 11-foot pole and some users won\u0027t want to think about any underlying config and just have \"please just do this for me, whatever\". Those are the two different scenarios that I hope we can support. I.e. with the suggested commands we can still get good performance for developers that want to audit config changes. Does that make sense?",
      "parentUuid": "7015b774_95b8e09f",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "980daa5a_4bf83a26",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 1560543
      },
      "writtenOn": "2024-12-05T18:39:51Z",
      "side": 1,
      "message": "I believe the user would still be able to decide for themselves with my suggestion, but what you are suggesting sounds even better. Certainly a win if we can remove gitPostprocessVersion - it would simplify the code, make future changes easier, and if we use `git config --global --list`, it should keep the bootstrap latency the same.\n\nAnne, wdyt?",
      "parentUuid": "2d36b3b7_7de34398",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc6548a3_375045d6",
        "filename": "bootstrap/bootstrap.py",
        "patchSetId": 2
      },
      "lineNbr": 366,
      "author": {
        "id": 3355336
      },
      "writtenOn": "2024-12-05T22:21:57Z",
      "side": 1,
      "message": "FWIW I think peter\u0027s idea is great, but also unnecessary.  This will only be used to set values specific to Windows, which is unlikely to change very much beyond the status quo.  Thus, we only need the bare minimum to ensure we aren\u0027t fiddling with users who explicitly don\u0027t want to be fiddled with, and the status quo meets that bar.\n\n(The \"problem\" with peter\u0027s idea is that it requires more complexity for a small use case; it\u0027s overkill IMO)\n\n(Also, IIRC there\u0027s more git config fiddling logic in \"core\" depot_tools that is not windows specific.  It might be better to merge the Windows specific config there as well, rather than re-implement it here in bootstrap.py.  But that is a large enough work that it should be done as a separate effort, if at all.)",
      "parentUuid": "980daa5a_4bf83a26",
      "revId": "dcf735e59587caf2b735db73c30df123064ec2c1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}